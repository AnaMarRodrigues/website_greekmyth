// Data dos mitos
const mythsData = [
    // Rivalries
    {
        id: 'contest-athens',
        title: 'The Contest for Athens',
        gods: 'Poseidon vs Athena',
        category: 'rivalry',
        description: 'In Greek mythology, Athens was founded after a contest between Athena and Poseidon for patronage of the city of Cecrops. Poseidon struck the ground with his trident, creating a saltwater spring that proved impractical for the people. Athena planted an olive tree, offering food, oil, wood, and lasting prosperity. King Cecrops judged Athena’s gift superior because of its practical benefits. Angered, Poseidon flooded parts of Attica and later caused droughts. Athena became the city’s patron goddess, and the city was renamed Athens.The Acropolis retained the older name Cecropia in honor of its first king.', 
    },
    {
        id: 'titanomachy',
        title: 'The Titanomachy',
        gods: 'Zeus and his brothers vs Kronos',
        category: 'rivalry',
        description: 'The Titanomachy, in Greek mythology, was the great war that occurred between the Titans, the old generation of Greek gods, and the Olympian gods, led by Zeus. The war lasted for a total of ten years, ending in the defeat of the old pantheon, and the establishment of the new one, based on Mount Olympus. Zeus, with the help of Metis, the Titan goddess who later became Zeus first wife, he gave Cronus a mixture of wine and mustard, causing him to vomit one by one the children he had swallowed. When all of his brothers and sisters were freed, Zeus gathered them and convinced them to start a rebellion against their father.'
    },
    {
        id: 'abduction-persephone',
        title: 'Abduction of Persephone',
        gods: 'Hades, Persephone, Demeter & Zeus',
        category: 'rivalry',
        description: 'When Persephone was playing in a flowery meadow with her Nymph companions, she was seized by Hasdes and carried off to the underworld as his bride. Her mother Demeter despaired at her dissappearance and searched for her the throughout the world. When she learned that Zeus had conspired in her daughter´s abduction she was furious, and refused to let the earth fruit until Persephone was returned. Zeus consented, but because the girl had tasted of the food of Hades,a handful of pomegranate seeds, she was forced to forever spend a part of the year with her husband in the underworld.'
    },
    {
        id: 'war-wisdom',
        title: 'War God vs Wisdom',
        gods: 'Ares vs Athena',
        category: 'rivalry',
        description: 'Ares and Athena represent two opposing views of war in Greek mythology. While Ares symbolizes brutal violence, chaos, and impulsive combat, Athena embodies strategic warfare guided by intelligence and discipline. Ares fights driven by rage and the pleasure of destruction, without planning or justice. Athena, on the other hand, fights only when necessary, using wisdom and careful strategy. Their rivalry is clearly shown in myths such as the Trojan War. In these stories, Athena repeatedly outsmarts and overcomes Ares.Together, they reflect the Greek belief that intelligence is superior to brute force in war.'
    },
    {
        id: 'trojan-war-artemis',
        title: 'Trojan War',
        gods: 'Artemis & Hera',
        category: 'rivalry',
        description: 'After the death of Patroklos, Akhilleus returned to the war, and Zeus again allowed the gods to return to Troy in support of their favourites. The divine factions then broke out into open conflict: Artemis stood against Hera and was beaten by the goddess. <br> <br><i style="color:#a44c56; font-weight:500; font-size:11px"> "Are you proposing to stand up to me? I know your bow and arrows, and what lioness you are to women, whom Zeus allows you to destroy at your discretion; but if you match yourself with me you will regret it. You would find it better sport to slaughter wild deer in the mountains than to fight your superiors." </i> <br>(Hera to Artemis. Homer, Iliad 21.470).'
    },
   
    {
        id: 'brothers-divide',
        title: 'Brothers\' Divide',
        gods: 'Zeus, Poseidon & Hades',
        category: 'rivalry',
        description: 'Hades, grew dissatisfied with his domain and felt overlooked compared to his brothers, Zeus and Poseidon. Driven by a desire for recognition, he proposed bringing the underworld to Earth. The gods debated his idea for days, weighing the consequences of merging the realms. In the end, the other gods rejected Hades’ plan, recognizing that such a fusion would upset the balance of the cosmos. Hades reluctantly returned to the underworld, learning that power alone did not grant respect or happiness. He continued to rule his domain wisely, understanding that each god’s realm had its unique role and importance in the world.'
    },
    {
  id: 'judgment-paris',
  title: 'The Judgment of Paris',
  gods: 'Hera, Athena, Aphrodite & Zeus',
  category: 'rivalry',
  description: 'The Judgement of Paris was a contest between the three most beautiful goddesses of Olympus—Aphrodite, Hera, and Athena—for a golden apple inscribed “To the Fairest.” At a feast of the gods, Eris the goddess of discord threw down the apple, and Zeus ordered Paris of Troy to judge the prize. Paris led the goddesses to him; each offered gifts to entice his choice. He awarded the apple to Aphrodite, who had promised him the love of Helen of Sparta, the most beautiful mortal woman. Paris’s choice brought about Helen’s departure to Troy and directly led to the Trojan War.'
    },
{
  id: 'athena-hephaestus',
  title: 'Erichthonius',
  gods: 'Athena & Hephaestus',
  category: 'rivalry',
  description: 'The most famous son of Hephaestus was probably Erichthonius, the man who became king of Athens. Hephaestus sought to have a relationship with the beautiful Athena, but the goddess spurned his advances. When Hephaestus tried to force himself on the goddess, he ejaculated upon the thigh of the goddess, who subsequently brushed the semen away. The semen fell onto Gaia, the earth, who became pregnant, and so was born Erichthonius. Athena felt a certain responsibility for this child and raised it as her own in the temple of the Akropolis.'
},


    
    // Love Stories
    {
        id: 'zeus-hera-union',
        title: 'Zeus and Hera\'s Union',
        gods: 'Zeus & Hera',
        category: 'love',
        description: 'Zeus was notorious for courting countless women. But it was Hera, with whom he was enchanted. He wanted to have her by his side as the queen of the gods. Hera, however, had no intention of ever becoming Zeus’ wife. She rejected all the marriage proposals she received from him. Zeus formulated a plan that would see Hera soften her hard stance. One day, he transformed himself into a rain-soaked helpless little bird. When Hera saw the little bird, she took pity on it. She took the little creature and nestled it. At that moment, Zeus transformed back into his true form, and Hera couldn’t help it. She fell in love with him. This time, when he asked her to be his wife, she obliged.'
    },
    {
        id: 'ares-aphrodite',
        title: 'Ares and Aphrodite\'s Affair',
        gods: 'Ares & Aphrodite',
        category: 'love',
        description: 'Ares and Aphrodite carried on a passionate affair despite her marriage to Hephaestus. Their union produced several children including Eros and Harmonia, representing the connection between love and war.'
    },
    {
  id: 'hermes-aphrodite',
  title: 'Birth of Hermaphroditus',
  gods: 'Hermes & Aphrodite',
  category: 'love',
  description: 'Hermaphroditus was the son of Hermes and Aphrodite, and he was counted among the winged love gods called Erotes. In one myth, he attracted the love of the nymph Salmacis, who prayed to be united with him forever. The gods answered her prayer by merging their two forms into one—creating his combined male‑female form and giving his name to the term hermaphrodite.'
},

    
    // Alliances
    {
        id: 'birth-athena',
        title: 'Birth of Athena',
        gods: 'Zeus & Athena',
        category: 'alliance',
        description: 'Zeus slept with Metis. When she was pregnant, Zeus took the precaution of swallowing her, because she had said that, after giving birth to the daughter presently in her womb, she would bear a son who would gain the lordship of the sky. In fear of this he swallowed her. When it came time for the birth, Prometheus (or Hephaistos, according to some) by the river Triton struck the head of Zeus with an axe, and from his crown Athena sprang up, clad in her armour.'
    },
    {
        id: 'twin-archers',
        title: 'The Twin Archers',
        gods: 'Apollo & Artemis',
        category: 'alliance',
        description: 'Apollo and Artemis, twin children of Zeus and Leto, share a deep bond. Apollo rules over the sun and prophecy, while Artemis governs the moon and hunt, working in harmony across different realms.'
    },
    {
        id: 'hermes-messenger',
        title: 'Hermes the Messenger',
        gods: 'Zeus & Hermes',
        category: 'alliance',
        description: 'Hermes serves as Zeus\'s personal messenger and most reliable agent, carrying out his will across all realms with speed and cunning. Their alliance represents trust and loyalty among the gods.'
    },
    {
        id: 'brothers-alliance',
        title: 'Brothers\' Alliance',
        gods: 'Zeus & Poseidon',
        category: 'alliance',
        description: 'Despite occasional disagreements, Poseidon and Zeus maintained their alliance as the two most powerful Olympian brothers, ruling sea and sky in balance and protecting the divine order.'
    },
    {
  id: 'hermes-apollo-cattle',
  title: 'Lyre apology',
  gods: 'Hermes & Apollo',
  category: 'alliance',
  description: 'Shortly after his birth, Hermes stole Apollo’s sacred cattle, cleverly disguising their tracks. When confronted, Hermes offered Apollo the lyre he had invented, enchanting the god of music. In exchange, Apollo forgave him and gave Hermes the caduceus. This myth marks the beginning of their lasting alliance.'
},
{
  id: 'hera-athena-alliance',
  title: 'Hera and Athena',
  gods: 'Hera & Athena',
  category: 'alliance',
  description: 'After being humiliated in the Judgment of Paris, Hera and Athena formed a lasting alliance. Throughout the Trojan War, they worked together to oppose Troy, supporting the Greek forces with strategy, deception, and divine intervention.'
},


    
];

// Função para gerar as cartas dinamicamente
function generateMythCards() {
    const mythsGrid = document.getElementById('mythsGrid');
    mythsGrid.innerHTML = ''; // Limpar conteúdo existente

    mythsData.forEach(myth => {
        // Criar elemento da carta
        const card = document.createElement('div');
        card.className = `myth-card ${myth.category}`;
        card.setAttribute('data-category', myth.category);
        card.setAttribute('data-id', myth.id);

        // HTML da carta
        card.innerHTML = `
            <img src="images/svg/carta myths.svg" class="myth-card-bg" alt="">
            <div class="myth-card-content">
                <h2 class="myth-title">${myth.title}</h2>
                <p class="myth-gods">${myth.gods}</p>
                <div class="myth-divider"></div>
                <p class="myth-description">${myth.description}</p>
                <a href="familytree.html" class="myth-card-btn">View in Tree</a>
            </div>
        `;

        mythsGrid.appendChild(card);
    });
}

// Sistema de filtros
function initializeFilters() {
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            // Don't do anything if it's the clear filter button
            if (btn.classList.contains('clear-filter-btn')) return;
            
            // Remover active de todos
            filterBtns.forEach(b => b.classList.remove('active'));
            // Adicionar active ao clicado
            btn.classList.add('active');

            const category = btn.dataset.category;
            const mythCards = document.querySelectorAll('.myth-card');

            // Filtrar cartas
            mythCards.forEach(card => {
                if (category === 'all') {
                    card.style.display = 'flex';
                } else {
                    if (card.dataset.category === category) {
                        card.style.display = 'flex';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
            
            // Remover "no results" 
            const noResults = document.querySelector('.no-results');
            if (noResults) noResults.remove();
            
            // Reset title 
            const titleSection = document.querySelector('.myths-title-section h2');
            if (titleSection && !titleSection.textContent.includes('featuring')) {
                titleSection.textContent = 'Categories of Myths:';
            }
        });
    });
}

// Função para filtrar mitos por deus
function filterMythsByGod(godName) {
    const mythCards = document.querySelectorAll('.myth-card');
    let hasResults = false;

    console.log('Filtering by god:', godName);
    console.log('Total cards found:', mythCards.length);

    mythCards.forEach(card => {
        const gods = card.querySelector('.myth-gods').textContent;
        console.log('Card gods:', gods, 'Includes', godName, '?', gods.toLowerCase().includes(godName.toLowerCase()));
        
        // Check if the god's name appears in the "gods" field
        if (gods.toLowerCase().includes(godName.toLowerCase())) {
            card.style.display = 'flex'; // Force display
            hasResults = true;
        } else {
            card.style.display = 'none'; // Force hide
        }
    });

    // Update filter buttons - deactivate all
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });

    // Show message if no results
    if (!hasResults) {
        const mythsGrid = document.getElementById('mythsGrid');
        const noResults = document.createElement('p');
        noResults.className = 'no-results';
        noResults.textContent = `No myths found featuring ${godName}`;
        noResults.style.cssText = 'text-align: center; grid-column: 1/-1; padding: 2rem; font-size: 1.2rem; color: #666;';
        mythsGrid.appendChild(noResults);
    }

    console.log('Has results:', hasResults);
}

// Function to add "clear filter" button when filtering by god
function addClearFilterButton(godName) {
    const filterContainer = document.querySelector('.filter-container');
    if (filterContainer && !document.querySelector('.clear-filter-btn')) {
        const clearBtn = document.createElement('button');
        clearBtn.className = 'filter-btn clear-filter-btn';
        clearBtn.style.cssText = 'background: #130d1ad3; color: #eae4dc;';
        clearBtn.textContent = '✕ Clear filter';
        clearBtn.addEventListener('click', () => {
            window.location.href = 'myths.html';
        });
        filterContainer.appendChild(clearBtn);
    }
}

// Inicializar quando o DOM carregar
document.addEventListener('DOMContentLoaded', () => {
    // Generate cards first
    generateMythCards();
    initializeFilters();

    // Check if there's a god parameter in the URL
    const urlParams = new URLSearchParams(window.location.search);
    const godName = urlParams.get('god');
    
    if (godName) {
        // Wait a bit for cards to be fully rendered, then filter
        setTimeout(() => {
            filterMythsByGod(godName);
            
            // Update the header to show filtering
            const titleSection = document.querySelector('.myths-title-section h2');
            if (titleSection) {
                titleSection.textContent = `Myths featuring ${godName}:`;
            }
            
            // Add a clear filter button
            addClearFilterButton(godName);
        }, 100);
    }
});


// GSAP animations - Entrance animation for myths page
gsap.from('.myths-header', {
    y: -30,
    opacity: 0,
    duration: 0.8,
    ease: "power2.out"
});

gsap.from('.myth-card', {
     y: -30,
    opacity: 0,
    duration: 0.8,
    ease: "power2.out"
});

// GSAP footer animation
gsap.timeline()
  .fromTo('.footerhome .star', 
    { opacity: 0, scale: 0 }, 
    { opacity: 1, scale: 1, duration: 0.8, ease: "back.out(1.7)" }
  )
  .to('.footerhome .line', {
    scaleX: 1,
    duration: 1,
    ease: "power2.out",
    stagger: 0.15
  });